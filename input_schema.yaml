steps:
    create:
        id: create
        input:
            objects:
                Connection:
                    id: Connection
                    properties:
                        bearerToken:
                            type:
                                type_id: string
                            display:
                                name: Bearer token
                                description: Bearer token to authenticate against the Kubernetes API with.
                            required: false
                        burst:
                            type:
                                min: 0
                                type_id: integer
                            display:
                                name: Burst
                                description: Burst value for query throttling.
                            required: false
                            default: "10"
                        cacert:
                            type:
                                min: 1
                                pattern: {}
                                type_id: string
                            display:
                                name: CA certificate
                                description: CA certificate in PEM format to verify Kubernetes server certificate against.
                            required: false
                            required_if:
                                - cert
                                - key
                        cert:
                            type:
                                min: 1
                                pattern: {}
                                type_id: string
                            display:
                                name: Client certificate
                                description: Client certificate in PEM format to authenticate against Kubernetes with.
                            required: false
                            required_if:
                                - key
                        host:
                            type:
                                type_id: string
                            display:
                                name: Host
                                description: Host name and port of the Kubernetes server
                            required: false
                            default: '"kubernetes.default.svc"'
                        key:
                            type:
                                min: 1
                                pattern: {}
                                type_id: string
                            display:
                                name: Client key
                                description: Client private key in PEM format to authenticate against Kubernetes with.
                            required: false
                            required_if:
                                - cert
                        password:
                            type:
                                type_id: string
                            display:
                                name: Password
                                description: Password for basic authentication.
                            required: false
                            required_if:
                                - username
                        path:
                            type:
                                type_id: string
                            display:
                                name: Path
                                description: Path to the API server.
                            required: false
                            default: '"/api"'
                        qps:
                            type:
                                min: 0
                                units:
                                    baseunitvalue:
                                        name_short_singular: q
                                        name_short_plural: q
                                        name_long_singular: query
                                        name_long_plural: queries
                                    multipliersvalue: {}
                                type_id: float
                            display:
                                name: QPS
                                description: Queries Per Second allowed against the API.
                            required: false
                            default: "5.0"
                        serverName:
                            type:
                                type_id: string
                            display:
                                name: TLS server name
                                description: Expected TLS server name to verify in the certificate.
                            required: false
                        username:
                            type:
                                type_id: string
                            display:
                                name: Username
                                description: Username for basic authentication.
                            required: false
                            required_if:
                                - password
                    type_id: ""
                ObjectMeta:
                    id: ObjectMeta
                    properties:
                        annotations:
                            type:
                                keys:
                                    pattern: {}
                                    type_id: string
                                values:
                                    max: 63
                                    pattern: {}
                                    type_id: string
                                type_id: map
                            display:
                                name: Annotations
                                description: Kubernetes annotations to appy. See https://kubernetes.io/docs/concepts/overview/working-with-objects/annotations/ for details.
                            required: false
                        generateName:
                            type:
                                type_id: string
                            display:
                                name: Name prefix
                                description: Name prefix to generate pod names from.
                            required: false
                            conflicts:
                                - name
                        labels:
                            type:
                                keys:
                                    pattern: {}
                                    type_id: string
                                values:
                                    max: 63
                                    pattern: {}
                                    type_id: string
                                type_id: map
                            display:
                                name: Labels
                                description: Kubernetes labels to appy. See https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/ for details.
                            required: false
                        name:
                            type:
                                type_id: string
                            display:
                                name: Name
                                description: Resource name.
                            required: false
                            conflicts:
                                - generateName
                        namespace:
                            type:
                                max: 253
                                pattern: {}
                                type_id: string
                            display:
                                name: Namespace
                                description: Kubernetes namespace to deploy in.
                            required: false
                            default: '"default"'
                    type_id: ""
                Service:
                    id: Service
                    properties:
                        metadata:
                            type:
                                id: ObjectMeta
                                display: null
                                type_id: ref
                            display:
                                name: Metadata
                                description: Service metadata.
                            required: false
                        spec:
                            type:
                                id: ServiceSpec
                                properties:
                                    ports:
                                        type:
                                            items:
                                                id: ServicePort
                                                properties:
                                                    appProtocol:
                                                        type:
                                                            max: 63
                                                            pattern: {}
                                                            type_id: string
                                                        display:
                                                            name: App protocol
                                                            description: The application protocol for this port. See RFC6335.
                                                        required: false
                                                    name:
                                                        type:
                                                            max: 253
                                                            pattern: {}
                                                            type_id: string
                                                        display:
                                                            name: Name
                                                            description: The name of this port within the service.
                                                        required: false
                                                    port:
                                                        type:
                                                            min: 1
                                                            max: 65535
                                                            type_id: integer
                                                        display:
                                                            name: Port
                                                            description: Port number that will be exposed.
                                                        required: false
                                                    protocol:
                                                        type:
                                                            values:
                                                                SCTP:
                                                                    name: SCTP
                                                                    description: null
                                                                TCP:
                                                                    name: TCP
                                                                    description: null
                                                                UDP:
                                                                    name: UDP
                                                                    description: null
                                                            type_id: enum_string
                                                        display:
                                                            name: Protocol
                                                            description: Protocol for this service.
                                                        required: true
                                                type_id: ""
                                            min: null
                                            max: null
                                            type_id: list
                                        display:
                                            name: Ports
                                            description: Ports for this service.
                                        required: false
                                    selector:
                                        type:
                                            keys:
                                                pattern: {}
                                                type_id: string
                                            values:
                                                max: 63
                                                pattern: {}
                                                type_id: string
                                            type_id: map
                                        display:
                                            name: Selector
                                            description: Target selector.
                                        required: false
                                type_id: ""
                            display:
                                name: Specification
                                description: Service specification.
                            required: false
                    type_id: ""
                input:
                    id: input
                    properties:
                        connection:
                            type:
                                id: Connection
                                display: null
                                type_id: ref
                            display:
                                name: Kubernetes
                                description: Kubernetes connection parameters.
                            required: true
                        service:
                            type:
                                id: Service
                                display: null
                                type_id: ref
                            display:
                                name: Service
                                description: Service to create.
                            required: true
                    type_id: ""
            root: input
        outputs:
            error:
                schema:
                    objects:
                        error:
                            id: error
                            properties:
                                error:
                                    type:
                                        type_id: string
                                    display:
                                        name: Error message
                                        description: null
                                    required: true
                            type_id: ""
                    root: error
                display:
                    name: Error
                    description: Service creation failed.
                error: true
            success:
                schema:
                    objects:
                        success:
                            id: success
                            properties:
                                name:
                                    type:
                                        max: 253
                                        pattern: {}
                                        type_id: string
                                    display:
                                        name: Name
                                        description: Name of the service that has just been created.
                                    required: true
                            type_id: ""
                    root: success
                display:
                    name: Success
                    description: Service successfully created.
                error: false
        display:
            name: Create service
            description: Create a Kubernetes service with the given specification.

